def test_process_excel_to_markdown(load_module):
    mock_dp = MagicMock()
    mock_instance = MagicMock()

    mock_output = "## Table\n|A|B|\n|--|--|\n|1|2|"
    mock_instance.run_pipeline.return_value = mock_output
    mock_dp.return_value = mock_instance

    config_mock = {}  # not used by excel conversion
    return_values = {}

    file_path = "/some/file.xlsx"
    output_dir = "/output"

    with patch.object(load_module, "DocumentProcessing", mock_dp):
        result = load_module.process_excel_to_markdown(config_mock, file_path, output_dir, return_values)

    assert isinstance(result, dict)
    assert result.get("document_length") == len(mock_output)
